function mn(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),t.push.apply(t,r)}return t}function $(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?mn(Object(t),!0).forEach(function(r){we(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):mn(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function je(e){return(je=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(e)}function we(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function yt(e,n){return function(t){if(Array.isArray(t))return t}(e)||function(t,r){var o=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(o!=null){var s,a,c=[],d=!0,f=!1;try{for(o=o.call(t);!(d=(s=o.next()).done)&&(c.push(s.value),!r||c.length!==r);d=!0);}catch(h){f=!0,a=h}finally{try{d||o.return==null||o.return()}finally{if(f)throw a}}return c}}(e,n)||Un(e,n)||function(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function hn(e){return function(n){if(Array.isArray(n))return Ke(n)}(e)||function(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}(e)||Un(e)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function Un(e,n){if(e){if(typeof e=="string")return Ke(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set"?Array.from(e):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Ke(e,n):void 0}}function Ke(e,n){(n==null||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function ae(e){function n(t,r){Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),this.message=t,this.code=r}return n.prototype=new Error,n.prototype.name=e,n.prototype.constructor=n,n}var In=ae("LaunchDarklyUnexpectedResponseError"),Ye=ae("LaunchDarklyInvalidEnvironmentIdError"),$e=ae("LaunchDarklyInvalidUserError"),jn=ae("LaunchDarklyInvalidEventKeyError"),Rn=ae("LaunchDarklyInvalidArgumentError"),ie=ae("LaunchDarklyFlagFetchError"),Tn=ae("LaunchDarklyInvalidDataError");function De(e){return!(e>=400&&e<500)||e===400||e===408||e===429}for(var Cn=Object.freeze({__proto__:null,LDUnexpectedResponseError:In,LDInvalidEnvironmentIdError:Ye,LDInvalidUserError:$e,LDInvalidEventKeyError:jn,LDInvalidArgumentError:Rn,LDFlagFetchError:ie,LDInvalidDataError:Tn,isHttpErrorRecoverable:De}),H=[],Be=[],qe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",de=0,wt=qe.length;de<wt;++de)H[de]=qe[de],Be[qe.charCodeAt(de)]=de;function bt(e,n,t){for(var r,o,s=[],a=n;a<t;a+=3)r=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(H[(o=r)>>18&63]+H[o>>12&63]+H[o>>6&63]+H[63&o]);return s.join("")}Be["-".charCodeAt(0)]=62,Be["_".charCodeAt(0)]=63;var yn=Array.isArray,wn=Object.keys,kt=Object.prototype.hasOwnProperty,bn=["key","secondary","ip","country","email","firstName","lastName","avatar","name"];function Ee(e,n){return(e.endsWith("/")?e.substring(0,e.length-1):e)+(n.startsWith("/")?"":"/")+n}function Ze(e){return function(n){for(var t,r=n.length,o=r%3,s=[],a=0,c=r-o;a<c;a+=16383)s.push(bt(n,a,a+16383>c?c:a+16383));return o===1?(t=n[r-1],s.push(H[t>>2]+H[t<<4&63]+"==")):o===2&&(t=(n[r-2]<<8)+n[r-1],s.push(H[t>>10]+H[t>>4&63]+H[t<<2&63]+"=")),s.join("")}(function(n){for(var t=[],r=0;r<n.length;r++)t.push(n.charCodeAt(r));return t}(unescape(encodeURIComponent(e))))}function Se(e){return Ze(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function ke(e){return JSON.parse(JSON.stringify(e))}function He(e,n){return function t(r,o){if(r===o)return!0;if(r&&o&&typeof r=="object"&&typeof o=="object"){var s,a,c,d=yn(r),f=yn(o);if(d&&f){if((a=r.length)!=o.length)return!1;for(s=a;s--!=0;)if(!t(r[s],o[s]))return!1;return!0}if(d!=f)return!1;var h=r instanceof Date,v=o instanceof Date;if(h!=v)return!1;if(h&&v)return r.getTime()==o.getTime();var E=r instanceof RegExp,w=o instanceof RegExp;if(E!=w)return!1;if(E&&w)return r.toString()==o.toString();var p=wn(r);if((a=p.length)!==wn(o).length)return!1;for(s=a;s--!=0;)if(!kt.call(o,p[s]))return!1;for(s=a;s--!=0;)if(!t(r[c=p[s]],o[c]))return!1;return!0}return r!=r&&o!=o}(e,n)}function Q(e){setTimeout(e,0)}function oe(e,n){var t=e.then(function(r){return n&&setTimeout(function(){n(null,r)},0),r},function(r){if(!n)return Promise.reject(r);setTimeout(function(){n(r,null)},0)});return n?void 0:t}function Ln(e){var n={};for(var t in e)ne(e,t)&&(n[t]={value:e[t],version:0});return n}function Ge(e){var n={};for(var t in e)ne(e,t)&&(n[t]=e[t].value);return n}function xn(e,n){for(var t,r=n.slice(0),o=[],s=e;r.length>0;){for(t=[];s>0;){var a=r.shift();if(!a)break;(s-=Se(JSON.stringify(a)).length)<0&&t.length>0?r.unshift(a):t.push(a)}s=e,o.push(t)}return o}function An(e){var n=e.version||"3.8.2";return e.userAgent+"/"+n}function z(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return n.reduce(function(r,o){return $($({},r),o)},{})}function ne(e,n){return Object.prototype.hasOwnProperty.call(e,n)}function Nn(e){if(!e)return e;var n;for(var t in bn){var r=bn[t],o=e[r];o!==void 0&&typeof o!="string"&&((n=n||$({},e))[r]=String(o))}return n||e}for(var Fn=Object.freeze({__proto__:null,appendUrlPath:Ee,btoa:Ze,base64URLEncode:Se,clone:ke,deepEquals:He,onNextTick:Q,wrapPromiseCallback:oe,transformValuesToVersionedValues:Ln,transformVersionedValuesToValues:Ge,chunkUserEventsForUrl:xn,getLDUserAgentString:An,extend:z,objectHasOwnProperty:ne,sanitizeUser:Nn}),Et=function(e,n){return function(t){var r=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);if(r){var o=new Uint8Array(16);t.exports=function(){return r(o),o}}else{var s=new Array(16);t.exports=function(){for(var a,c=0;c<16;c++)!(3&c)&&(a=4294967296*Math.random()),s[c]=a>>>((3&c)<<3)&255;return s}}}(n={exports:{}}),n.exports}(),qn=[],Ie=0;Ie<256;++Ie)qn[Ie]=(Ie+256).toString(16).substr(1);var kn,_e,Ve=0,Me=0,en=function(e,n,t){var r=n&&t||0,o=n||[],s=(e=e||{}).node||kn,a=e.clockseq!==void 0?e.clockseq:_e;if(s==null||a==null){var c=Et();s==null&&(s=kn=[1|c[0],c[1],c[2],c[3],c[4],c[5]]),a==null&&(a=_e=16383&(c[6]<<8|c[7]))}var d=e.msecs!==void 0?e.msecs:new Date().getTime(),f=e.nsecs!==void 0?e.nsecs:Me+1,h=d-Ve+(f-Me)/1e4;if(h<0&&e.clockseq===void 0&&(a=a+1&16383),(h<0||d>Ve)&&e.nsecs===void 0&&(f=0),f>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Ve=d,Me=f,_e=a;var v=(1e4*(268435455&(d+=122192928e5))+f)%4294967296;o[r++]=v>>>24&255,o[r++]=v>>>16&255,o[r++]=v>>>8&255,o[r++]=255&v;var E=d/4294967296*1e4&268435455;o[r++]=E>>>8&255,o[r++]=255&E,o[r++]=E>>>24&15|16,o[r++]=E>>>16&255,o[r++]=a>>>8|128,o[r++]=255&a;for(var w=0;w<6;++w)o[r+w]=s[w];return n||function(p,O){var S=O||0,D=qn;return[D[p[S++]],D[p[S++]],D[p[S++]],D[p[S++]],"-",D[p[S++]],D[p[S++]],"-",D[p[S++]],D[p[S++]],"-",D[p[S++]],D[p[S++]],"-",D[p[S++]],D[p[S++]],D[p[S++]],D[p[S++]],D[p[S++]],D[p[S++]]].join("")}(o)},be=["debug","info","warn","error","none"];function _n(e,n){if(e&&e.destination&&typeof e.destination!="function")throw new Error("destination for basicLogger was set to a non-function");function t(E){return function(w){console&&console[E]&&console[E].call(console,w)}}var r=e&&e.destination?[e.destination,e.destination,e.destination,e.destination]:[t("log"),t("info"),t("warn"),t("error")],o=!(!e||!e.destination),s=e&&e.prefix!==void 0&&e.prefix!==null?e.prefix:"[LaunchDarkly] ",a=1;if(e&&e.level)for(var c=0;c<be.length;c++)be[c]===e.level&&(a=c);function d(E,w,p){if(!(p.length<1)){var O,S=o?w+": "+s:s;if(p.length!==1&&n){var D=hn(p);D[0]=S+D[0],O=n.apply(void 0,hn(D))}else O=S+p[0];try{r[E](O)}catch(U){console&&console.log&&console.log("[LaunchDarkly] Configured logger's "+w+" method threw an exception: "+U)}}}for(var f={},h=function(E){var w=be[E];if(w!=="none")if(E<a)f[w]=function(){};else{var p=E;f[w]=function(){d(p,w,arguments)}}},v=0;v<be.length;v++)h(v);return f}function nn(e,n){return _n({level:e,prefix:n})}function Te(e){return e&&e.message?e.message:typeof e=="string"||e instanceof String?e:JSON.stringify(e)}var ve=" Please see https://docs.launchdarkly.com/sdk/client-side/javascript#initializing-the-client for instructions on SDK initialization.",Vn=function(e){return'Expected application/json content type but got "'+e+'"'},Xe=function(e){return"local storage is unavailable: "+Te(e)},Mn=function(e){return"network error"+(e?" ("+e+")":"")},We=function(e){return'Custom event "'+e+'" does not exist'},zn=function(){return"Environment not found. Double check that you specified a valid environment/client-side ID."+ve},Jn=function(){return"No environment/client-side ID was specified."+ve},Re=function(e){return"Error fetching flag settings: "+Te(e)},Kn=function(){return"No user specified."+ve},$n=function(){return"Invalid user specified."+ve},Bn=function(){return"LaunchDarkly client was initialized with bootstrap data that did not include flag metadata. Events may not be sent correctly."+ve},Hn=function(e,n){return n?'"'+e+'" is deprecated, please use "'+n+'"':'"'+e+'" is deprecated'},Gn=function(e,n,t){return"Received error "+e+(e===401?" (invalid SDK key)":"")+" for "+n+" - "+(De(e)?t:"giving up permanently")},Xn=function(){return"Cannot make HTTP requests in this environment."+ve},Wn=function(e){return"Opening stream connection to "+e},Qn=function(e,n){return"Error on stream connection: "+Te(e)+", will continue retrying after "+n+" milliseconds."},Yn=function(e){return"Error on stream connection ".concat(Te(e),", giving up permanently")},Zn=function(e){return'Ignoring unknown config option "'+e+'"'},et=function(e,n,t){return'Config option "'+e+'" should be of type '+n+", got "+t+", using default value"},nt=function(e,n){return'Config option "'+e+'" should be a boolean, got '+n+", converting to boolean"},tt=function(e,n,t){return'Config option "'+e+'" was set to '+n+", changing to minimum value of "+t},rt=function(e){return"polling for feature flags at "+e},ot=function(e){return'received streaming update for flag "'+e+'"'},it=function(e){return'received streaming update for flag "'+e+'" but ignored due to version check'},at=function(e){return'received streaming deletion for flag "'+e+'"'},ut=function(e){return'received streaming deletion for flag "'+e+'" but ignored due to version check'},st=function(e){return'enqueueing "'+e+'" event'},ct=function(e){return"sending "+e+" events"},lt=function(e){return'Config option "'.concat(e,'" must only contain letters, numbers, ., _ or -.')},ft=function(e,n){return'an inspector: "'.concat(n,'" of an invalid type (').concat(e,") was configured")},dt=function(e,n){return'an inspector: "'.concat(n,'" of type: "').concat(e,'" generated an exception')},vt=function(e){return'Value of "'.concat(e,'" was longer than 64 characters and was discarded.')},tn=Object.freeze({__proto__:null,clientInitialized:function(){return"LaunchDarkly client initialized"},clientNotReady:function(){return"LaunchDarkly client is not ready"},eventCapacityExceeded:function(){return"Exceeded event queue capacity. Increase capacity to avoid dropping events."},eventWithoutUser:function(){return"Be sure to call `identify` in the LaunchDarkly client: https://docs.launchdarkly.com/sdk/features/identify#javascript"},invalidContentType:Vn,invalidKey:function(){return"Event key must be a string"},localStorageUnavailable:Xe,networkError:Mn,unknownCustomEventKey:We,environmentNotFound:zn,environmentNotSpecified:Jn,errorFetchingFlags:Re,userNotSpecified:Kn,invalidUser:$n,invalidData:function(){return"Invalid data received from LaunchDarkly; connection may have been interrupted"},bootstrapOldFormat:Bn,bootstrapInvalid:function(){return"LaunchDarkly bootstrap data is not available because the back end could not read the flags."},deprecated:Hn,httpErrorMessage:Gn,httpUnavailable:Xn,identifyDisabled:function(){return"identify() has no effect here; it must be called on the main client instance"},streamClosing:function(){return"Closing stream connection"},streamConnecting:Wn,streamError:Qn,unrecoverableStreamError:Yn,unknownOption:Zn,wrongOptionType:et,wrongOptionTypeBoolean:nt,optionBelowMinimum:tt,debugPolling:rt,debugStreamPing:function(){return"received ping message from stream"},debugStreamPut:function(){return"received streaming update for all flags"},debugStreamPatch:ot,debugStreamPatchIgnored:it,debugStreamDelete:at,debugStreamDeleteIgnored:ut,debugEnqueueingEvent:st,debugPostingEvents:ct,debugPostingDiagnosticEvent:function(e){return"sending diagnostic event ("+e.kind+")"},invalidTagValue:lt,invalidInspector:ft,inspectorMethodError:dt,tagValueTooLong:vt}),gt={baseUrl:{default:"https://app.launchdarkly.com"},streamUrl:{default:"https://clientstream.launchdarkly.com"},eventsUrl:{default:"https://events.launchdarkly.com"},sendEvents:{default:!0},streaming:{type:"boolean"},sendLDHeaders:{default:!0},requestHeaderTransform:{type:"function"},inlineUsersInEvents:{default:!1},allowFrequentDuplicateEvents:{default:!1},sendEventsOnlyForVariation:{default:!1},useReport:{default:!1},evaluationReasons:{default:!1},eventCapacity:{default:100,minimum:1},flushInterval:{default:2e3,minimum:2e3},samplingInterval:{default:0,minimum:0},streamReconnectDelay:{default:1e3,minimum:0},allAttributesPrivate:{default:!1},privateAttributeNames:{default:[]},bootstrap:{type:"string|object"},diagnosticRecordingInterval:{default:9e5,minimum:2e3},diagnosticOptOut:{default:!1},wrapperName:{type:"string"},wrapperVersion:{type:"string"},stateProvider:{type:"object"},autoAliasingOptOut:{default:!1},application:{validator:function(e,n,t){var r={};return n.id&&(r.id=En("".concat(e,".id"),n.id,t)),n.version&&(r.version=En("".concat(e,".version"),n.version,t)),r}},inspectors:{default:[]}},Dt=/^(\w|\.|-)+$/;function En(e,n,t){if(typeof n=="string"&&n.match(Dt)){if(!(n.length>64))return n;t.warn(vt(e))}else t.warn(lt(e))}function pt(e,n,t,r){var o=z({logger:{default:r}},gt,t),s={all_attributes_private:"allAttributesPrivate",private_attribute_names:"privateAttributeNames",samplingInterval:null,allowFrequentDuplicateEvents:void 0};function a(d){Q(function(){n&&n.maybeReportError(new Rn(d))})}var c=z({},e||{});return function(d){var f=d;Object.keys(s).forEach(function(h){if(f[h]!==void 0){var v=s[h];r&&r.warn(Hn(h,v)),v&&(f[v]===void 0&&(f[v]=f[h]),delete f[h])}})}(c),function(d){be.forEach(function(f){if(f!=="none"&&(!d[f]||typeof d[f]!="function"))throw new Error("Provided logger instance must support logger."+f+"(...) method")})}((c=function(d){var f=z({},d),h=function(v){if(v===null)return"any";if(v!==void 0){if(Array.isArray(v))return"array";var E=je(v);return E==="boolean"||E==="string"||E==="number"||E==="function"?E:"object"}};return Object.keys(d).forEach(function(v){var E=d[v];if(E!=null){var w=o[v];if(w===void 0)a(Zn(v));else{var p=w.type||h(w.default),O=w.validator;if(O){var S=O(v,d[v],r);S!==void 0?f[v]=S:delete f[v]}else if(p!=="any"){var D=p.split("|"),U=h(E);D.indexOf(U)<0?p==="boolean"?(f[v]=!!E,a(nt(v,U))):(a(et(v,p,U)),f[v]=w.default):U==="number"&&w.minimum!==void 0&&E<w.minimum&&(a(tt(v,E,w.minimum)),f[v]=w.minimum)}}}}),f}(c=function(d){var f=z({},d);return Object.keys(o).forEach(function(h){f[h]!==void 0&&f[h]!==null||(f[h]=o[h]&&o[h].default)}),f}(c))).logger),c}function mt(e){var n={};return e&&(e.application&&e.application.id!==void 0&&e.application.id!==null&&(n["application-id"]=[e.application.id]),e.application&&e.application.version!==void 0&&e.application.id!==null&&(n["application-version"]=[e.application.version])),n}function rn(e,n){if(n&&!n.sendLDHeaders)return{};var t={"X-LaunchDarkly-User-Agent":An(e)};n&&n.wrapperName&&(t["X-LaunchDarkly-Wrapper"]=n.wrapperVersion?n.wrapperName+"/"+n.wrapperVersion:n.wrapperName);var r=mt(n),o=Object.keys(r);return o.length&&(t["x-launchdarkly-tags"]=o.sort().map(function(s){return Array.isArray(r[s])?r[s].sort().map(function(a){return"".concat(s,"/").concat(a)}):["".concat(s,"/").concat(r[s])]}).reduce(function(s,a){return s.concat(a)},[]).join(" ")),t}function on(e,n){return n&&n.requestHeaderTransform?n.requestHeaderTransform($({},e)):e}function Dn(e,n,t){var r="/a/"+n+".gif",o=z({"Content-Type":"application/json"},rn(e,t)),s=e.httpFallbackPing,a={sendChunk:function(c,d,f,h){var v=JSON.stringify(c),E=f?null:en();return h?function w(p){var O=f?o:z({},o,{"X-LaunchDarkly-Event-Schema":"3","X-LaunchDarkly-Payload-ID":E});return e.httpRequest("POST",d,on(O,t),v).promise.then(function(S){if(S)return S.status>=400&&De(S.status)&&p?w(!1):function(D){var U={status:D.status},R=D.header("date");if(R){var F=Date.parse(R);F&&(U.serverTime=F)}return U}(S)}).catch(function(){return p?w(!1):Promise.reject()})}(!0).catch(function(){}):(s&&s(d+r+"?d="+Se(v)),Promise.resolve())},sendEvents:function(c,d,f){if(!e.httpRequest)return Promise.resolve();var h,v=e.httpAllowsPost();h=v?[c]:xn(2e3-d.length,c);for(var E=[],w=0;w<h.length;w++)E.push(a.sendChunk(h[w],d,f,v));return Promise.all(E)}};return a}function St(){var e={},n=0,t=0,r={};return e.summarizeEvent=function(o){if(o.kind==="feature"){var s=o.key+":"+(o.variation!==null&&o.variation!==void 0?o.variation:"")+":"+(o.version!==null&&o.version!==void 0?o.version:""),a=r[s];a?a.count=a.count+1:r[s]={count:1,key:o.key,variation:o.variation,version:o.version,value:o.value,default:o.default},(n===0||o.creationDate<n)&&(n=o.creationDate),o.creationDate>t&&(t=o.creationDate)}},e.getSummary=function(){var o={},s=!0;for(var a in r){var c=r[a],d=o[c.key];d||(d={default:c.default,counters:[]},o[c.key]=d);var f={value:c.value,count:c.count};c.variation!==void 0&&c.variation!==null&&(f.variation=c.variation),c.version?f.version=c.version:f.unknown=!0,d.counters.push(f),s=!1}return s?null:{startDate:n,endDate:t,features:o}},e.clearSummary=function(){n=0,t=0,r={}},e}function Ot(e){var n={},t=e.allAttributesPrivate,r=e.privateAttributeNames||[],o={key:!0,custom:!0,anonymous:!0},s={key:!0,secondary:!0,ip:!0,country:!0,email:!0,firstName:!0,lastName:!0,avatar:!0,name:!0,anonymous:!0,custom:!0};return n.filterUser=function(a){if(!a)return null;var c=a.privateAttributeNames||[],d=function(p,O){return Object.keys(p).reduce(function(S,D){var U=S;return O(D)&&(function(R){return!o[R]&&(t||c.indexOf(R)!==-1||r.indexOf(R)!==-1)}(D)?U[1][D]=!0:U[0][D]=p[D]),U},[{},{}])},f=d(a,function(p){return s[p]}),h=f[0],v=f[1];if(a.custom){var E=d(a.custom,function(){return!0});h.custom=E[0],v=z({},v,E[1])}var w=Object.keys(v);return w.length&&(w.sort(),h.privateAttrs=w),h},n}function Pt(e,n,t,r){var o={};function s(){var a="",c=r.getUser();return c&&(a=t||Ze(JSON.stringify(c))),"ld:"+n+":"+a}return o.loadFlags=function(){return e.get(s()).then(function(a){if(a==null)return null;try{var c=JSON.parse(a);if(c){var d=c.$schema;d===void 0||d<1?c=Ln(c):delete c.$schema}return c}catch{return o.clearFlags().then(function(){return null})}})},o.saveFlags=function(a){var c=z({},a,{$schema:1});return e.set(s(),JSON.stringify(c))},o.clearFlags=function(){return e.clear(s())},o}function Ut(e,n,t,r){var o,s=n.streamUrl,a=n.logger,c={},d=Ee(s,"/eval/"+t),f=n.useReport,h=n.evaluationReasons,v=n.streamReconnectDelay,E=rn(e,n),w=!1,p=null,O=null,S=null,D=null,U=null,R=0;function F(y){if(y.status&&typeof y.status=="number"&&!De(y.status))return x(),a.error(Yn(y)),void(O&&(clearTimeout(O),O=null));var C=function(){var N,K=(N=function(){var Z=v*Math.pow(2,R);return Z>3e4?3e4:Z}())-Math.trunc(.5*Math.random()*N);return R+=1,K}();w||(a.warn(Qn(y,C)),w=!0),V(!1),x(),J(C)}function J(y){O||(y?O=setTimeout(Y,y):Y())}function Y(){var y;O=null;var C="",N={headers:E,readTimeoutMillis:3e5};if(e.eventSourceFactory){for(var K in D!=null&&(C="h="+D),f?e.eventSourceAllowsReport?(y=d,N.method="REPORT",N.headers["Content-Type"]="application/json",N.body=JSON.stringify(S)):(y=Ee(s,"/ping/"+t),C=""):y=d+"/"+Se(JSON.stringify(S)),N.headers=on(N.headers,n),h&&(C=C+(C?"&":"")+"withReasons=true"),y=y+(C?"?":"")+C,x(),a.info(Wn(y)),o=new Date().getTime(),p=e.eventSourceFactory(y,N),U)ne(U,K)&&p.addEventListener(K,U[K]);p.onerror=F,p.onopen=function(){R=0}}}function x(){p&&(a.info("Closing stream connection"),p.close(),p=null)}function V(y){o&&r&&r.recordStreamInit(o,!y,new Date().getTime()-o),o=null}return c.connect=function(y,C,N){S=y,D=C,U={};var K=function(q){U[q]=function(T){w=!1,V(!0),N[q]&&N[q](T)}};for(var Z in N||{})K(Z);J()},c.disconnect=function(){clearTimeout(O),O=null,x()},c.isConnected=function(){return!!(p&&e.eventSourceIsActive&&e.eventSourceIsActive(p))},c}function It(e,n,t){var r=n.baseUrl,o=n.useReport,s=n.evaluationReasons,a=n.logger,c={},d={};function f(h,v){if(!e.httpRequest)return new Promise(function(D,U){U(new ie(Xn()))});var E=v?"REPORT":"GET",w=rn(e,n);v&&(w["Content-Type"]="application/json");var p=d[h];p||(p=function(D){var U,R,F,J,Y={addPromise:function(x,V){U=x,R&&R(),R=V,x.then(function(y){U===x&&(F(y),D&&D())},function(y){U===x&&(J(y),D&&D())})}};return Y.resultPromise=new Promise(function(x,V){F=x,J=V}),Y}(function(){delete d[h]}),d[h]=p);var O=e.httpRequest(E,h,on(w,n),v),S=O.promise.then(function(D){if(D.status===200){if(D.header("content-type")&&D.header("content-type").substring(0,16)==="application/json")return JSON.parse(D.body);var U=Vn(D.header("content-type")||"");return Promise.reject(new ie(U))}return Promise.reject(function(R){return R.status===404?new Ye(zn()):new ie(Re(R.statusText||String(R.status)))}(D))},function(D){return Promise.reject(new ie(Mn(D)))});return p.addPromise(S,function(){O.cancel&&O.cancel()}),p.resultPromise}return c.fetchJSON=function(h){return f(Ee(r,h),null)},c.fetchFlagSettings=function(h,v){var E,w,p,O="";return o?(w=[r,"/sdk/evalx/",t,"/user"].join(""),p=JSON.stringify(h)):(E=Se(JSON.stringify(h)),w=[r,"/sdk/evalx/",t,"/users/",E].join("")),v&&(O="h="+v),s&&(O=O+(O?"&":"")+"withReasons=true"),w=w+(O?"?":"")+O,a.debug(rt(w)),f(w,p)},c}function jt(e){var n={validateUser:function(t){if(!t)return Promise.reject(new $e(Kn()));var r=ke(t);return r.key!==null&&r.key!==void 0?(r.key=r.key.toString(),Promise.resolve(r)):r.anonymous?e.get("ld:$anonUserId").then(function(o){if(o)return r.key=o,r;var s=en();return r.key=s,function(a){return e.set("ld:$anonUserId",a)}(s).then(function(){return r})}):Promise.reject(new $e($n()))}};return n}var ze=Object.freeze({__proto__:null,baseOptionDefs:gt,validate:pt,getTags:mt}).baseOptionDefs,Rt=Fn.appendUrlPath,Tt=function(e){var n={diagnosticId:en()};return e&&(n.sdkKeySuffix=e.length>6?e.substring(e.length-6):e),n},A={flagUsed:"flag-used",flagDetailsChanged:"flag-details-changed",flagDetailChanged:"flag-detail-changed",clientIdentityChanged:"client-identity-changed"};function Ct(e,n){var t,r={},o=(we(t={},A.flagUsed,[]),we(t,A.flagDetailsChanged,[]),we(t,A.flagDetailChanged,[]),we(t,A.clientIdentityChanged,[]),t);return(e==null?void 0:e.map(function(s){return function(a,c){var d=!1,f={type:a.type,name:a.name,method:function(){try{a.method.apply(a,arguments)}catch{d||(d=!0,c.warn(dt(f.type,f.name)))}}};return f}(s,n)})).forEach(function(s){Object.prototype.hasOwnProperty.call(o,s.type)?o[s.type].push(s):n.warn(ft(s.type,s.name))}),r.hasListeners=function(s){var a;return(a=o[s])===null||a===void 0?void 0:a.length},r.onFlagUsed=function(s,a,c){o[A.flagUsed].length&&Q(function(){o[A.flagUsed].forEach(function(d){return d.method(s,a,c)})})},r.onFlags=function(s){o[A.flagDetailsChanged].length&&Q(function(){o[A.flagDetailsChanged].forEach(function(a){return a.method(s)})})},r.onFlagChanged=function(s,a){o[A.flagDetailChanged].length&&Q(function(){o[A.flagDetailChanged].forEach(function(c){return c.method(s,a)})})},r.onIdentityChanged=function(s){o[A.clientIdentityChanged].length&&Q(function(){o[A.clientIdentityChanged].forEach(function(a){return a.method(s)})})},r}function ht(e,n,t,r,o){var s,a,c,d=t&&t.logger?t.logger:o&&o.logger&&o.logger.default||nn("warn"),f=function(i){var l={},u={};return l.on=function(g,b,m){u[g]=u[g]||[],u[g]=u[g].concat({handler:b,context:m})},l.off=function(g,b,m){if(u[g])for(var k=0;k<u[g].length;k++)u[g][k].handler===b&&u[g][k].context===m&&(u[g]=u[g].slice(0,k).concat(u[g].slice(k+1)))},l.emit=function(g){if(u[g])for(var b=u[g].slice(0),m=0;m<b.length;m++)b[m].handler.apply(b[m].context,Array.prototype.slice.call(arguments,1))},l.getEvents=function(){return Object.keys(u)},l.getEventListenerCount=function(g){return u[g]?u[g].length:0},l.maybeReportError=function(g){g&&(u.error?this.emit("error",g):(i||console).error(g.message))},l}(d),h=function(i){var l=!1,u=!1,g=null,b=null,m=new Promise(function(k){i.on("ready",function P(){i.off("ready",P),k()})}).catch(function(){});return{getInitializationPromise:function(){return b||(l?Promise.resolve():u?Promise.reject(g):b=new Promise(function(k,P){i.on("initialized",function L(){i.off("initialized",L),k()}),i.on("failed",function L(B){i.off("failed",L),P(B)})}))},getReadyPromise:function(){return m},signalSuccess:function(){l||u||(l=!0,i.emit("initialized"),i.emit("ready"))},signalFailure:function(k){l||u||(u=!0,g=k,i.emit("failed",k),i.emit("ready")),i.maybeReportError(k)}}}(f),v=pt(t,f,o,d),E=Ct(v.inspectors,d),w=v.sendEvents,p=e,O=v.hash,S=function(i,l){var u={},g=!1,b=function(m){g||(g=!0,l.warn(Xe(m)))};return u.isEnabled=function(){return!!i},u.get=function(m){return new Promise(function(k){i?i.get(m).then(k).catch(function(P){b(P),k(void 0)}):k(void 0)})},u.set=function(m,k){return new Promise(function(P){i?i.set(m,k).then(function(){return P(!0)}).catch(function(L){b(L),P(!1)}):P(!1)})},u.clear=function(m){return new Promise(function(k){i?i.clear(m).then(function(){return k(!0)}).catch(function(P){b(P),k(!1)}):k(!1)})},u}(r.localStorage,d),D=Dn(r,p,v),U=v.sendEvents&&!v.diagnosticOptOut,R=U?Tt(p):null,F=U?function(i){var l,u,g,b;function m(k){l=k,u=0,g=0,b=[]}return m(i),{getProps:function(){return{dataSinceDate:l,droppedEvents:u,eventsInLastBatch:g,streamInits:b}},setProps:function(k){l=k.dataSinceDate,u=k.droppedEvents||0,g=k.eventsInLastBatch||0,b=k.streamInits||[]},incrementDroppedEvents:function(){u++},setEventsInLastBatch:function(k){g=k},recordStreamInit:function(k,P,L){var B={timestamp:k,failed:P,durationMillis:L};b.push(B)},reset:m}}(new Date().getTime()):null,J=U?function(i,l,u,g,b,m,k){var P,L,B=!!i.diagnosticUseCombinedEvent,le="ld:"+b+":$diagnostics",Pe=Rt(m.eventsUrl,"/events/diagnostic/"+b),fe=m.diagnosticRecordingInterval,ee=u,Ue=!!m.streaming,te={};function me(){return{sdk:he(),configuration:(j={customBaseURI:m.baseUrl!==ze.baseUrl.default,customStreamURI:m.streamUrl!==ze.streamUrl.default,customEventsURI:m.eventsUrl!==ze.eventsUrl.default,eventsCapacity:m.eventCapacity,eventsFlushIntervalMillis:m.flushInterval,reconnectTimeMillis:m.streamReconnectDelay,streamingDisabled:!Ue,allAttributesPrivate:!!m.allAttributesPrivate,inlineUsersInEvents:!!m.inlineUsersInEvents,diagnosticRecordingIntervalMillis:m.diagnosticRecordingInterval,usingSecureMode:!!m.hash,bootstrapMode:!!m.bootstrap,fetchGoalsDisabled:!m.fetchGoals,sendEventsOnlyForVariation:!!m.sendEventsOnlyForVariation,autoAliasingOptOut:!!m.autoAliasingOptOut},j),platform:i.diagnosticPlatformData};var j}function re(j){m.logger&&m.logger.debug(tn.debugPostingDiagnosticEvent(j)),g.sendEvents(j,Pe,!0).then(function(){}).catch(function(){})}function G(){var j,M;re((j=new Date().getTime(),M=$({kind:B?"diagnostic-combined":"diagnostic",id:k,creationDate:j},ee.getProps()),B&&(M=$($({},M),me())),ee.reset(j),M)),L=setTimeout(G,fe),P=new Date().getTime(),B&&function(){if(l.isEnabled()){var X=$({},ee.getProps());l.set(le,JSON.stringify(X))}}()}function he(){var j=$({},i.diagnosticSdkData);return m.wrapperName&&(j.wrapperName=m.wrapperName),m.wrapperVersion&&(j.wrapperVersion=m.wrapperVersion),j}return te.start=function(){B?function(j){if(!l.isEnabled())return j(!1);l.get(le).then(function(M){if(M)try{var X=JSON.parse(M);ee.setProps(X),P=X.dataSinceDate}catch{}j(!0)}).catch(function(){j(!1)})}(function(j){if(j){var M=(P||0)+fe,X=new Date().getTime();X>=M?G():L=setTimeout(G,M-X)}else Math.floor(4*Math.random())===0?G():L=setTimeout(G,fe)}):(re($({kind:"diagnostic-init",id:k,creationDate:ee.getProps().dataSinceDate},me())),L=setTimeout(G,fe))},te.stop=function(){L&&clearTimeout(L)},te.setStreaming=function(j){Ue=j},te}(r,S,F,D,p,v,R):null,Y=Ut(r,v,p,F),x=v.eventProcessor||function(i,l,u){var g,b=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,m=arguments.length>4&&arguments[4]!==void 0?arguments[4]:null,k=arguments.length>5&&arguments[5]!==void 0?arguments[5]:null,P={},L=k||Dn(i,u,l),B=Ee(l.eventsUrl,"/events/bulk/"+u),le=St(),Pe=Ot(l),fe=l.inlineUsersInEvents,ee=l.samplingInterval,Ue=l.eventCapacity,te=l.flushInterval,me=l.logger,re=[],G=0,he=!1,j=!1;function M(){return ee===0||Math.floor(Math.random()*ee)===0}function X(I){return!!I.debugEventsUntilDate&&I.debugEventsUntilDate>G&&I.debugEventsUntilDate>new Date().getTime()}function gn(I){var _=z({},I);return I.kind==="alias"||(fe||I.kind==="identify"?_.user=Pe.filterUser(I.user):(_.userKey=I.user.key,delete _.user),I.kind==="feature"&&(delete _.trackEvents,delete _.debugEventsUntilDate)),_}function pn(I){re.length<Ue?(re.push(I),j=!1):(j||(j=!0,me.warn("Exceeded event queue capacity. Increase capacity to avoid dropping events.")),b&&b.incrementDroppedEvents())}return P.enqueue=function(I){if(!he){var _=!1,W=!1;if(le.summarizeEvent(I),I.kind==="feature"?M()&&(_=!!I.trackEvents,W=X(I)):_=M(),_&&pn(gn(I)),W){var ye=z({},I,{kind:"debug"});ye.user=Pe.filterUser(ye.user),delete ye.trackEvents,delete ye.debugEventsUntilDate,pn(ye)}}},P.flush=function(){if(he)return Promise.resolve();var I=re,_=le.getSummary();return le.clearSummary(),_&&(_.kind="summary",I.push(_)),b&&b.setEventsInLastBatch(I.length),I.length===0?Promise.resolve():(re=[],me.debug(ct(I.length)),L.sendEvents(I,B).then(function(W){W&&(W.serverTime&&(G=W.serverTime),De(W.status)||(he=!0),W.status>=400&&Q(function(){m.maybeReportError(new In(Gn(W.status,"event posting","some events were dropped")))}))}))},P.start=function(){g=setTimeout(function I(){P.flush(),g=setTimeout(I,te)},te)},P.stop=function(){clearTimeout(g)},P}(r,v,p,F,f,D),V=It(r,v,p),y={},C=v.streaming,N=!1,K=!1,Z=!0,q=v.stateProvider,T=function(i,l){var u,g={setUser:function(b){var m=u&&ke(u);(u=Nn(b))&&l&&l(ke(u),m)},getUser:function(){return u?ke(u):null}};return g}(0,function(i,l){(function(u){q||u&&ge({kind:"identify",key:u.key,user:u,creationDate:new Date().getTime()})})(i),!v.autoAliasingOptOut&&l&&l.anonymous&&i&&!i.anonymous&&ln(i,l),E.hasListeners(A.clientIdentityChanged)&&E.onIdentityChanged(T.getUser())}),an=jt(S),ue=S.isEnabled()?new Pt(S,p,O,T):null;function ge(i){if(p&&!(q&&q.enqueueEvent&&q.enqueueEvent(i))){if(i.kind!=="alias"){if(!i.user)return void(Z&&(d.warn("Be sure to call `identify` in the LaunchDarkly client: https://docs.launchdarkly.com/sdk/features/identify#javascript"),Z=!1));Z=!1}!w||K||r.isDoNotTrack()||(d.debug(st(i.kind)),x.enqueue(i))}}function un(i,l){E.hasListeners(A.flagDetailChanged)&&E.onFlagChanged(i.key,se(l))}function sn(){E.hasListeners(A.flagDetailsChanged)&&E.onFlags(Object.entries(y).map(function(i){var l=yt(i,2);return{key:l[0],detail:se(l[1])}}).reduce(function(i,l){return i[l.key]=l.detail,i},{}))}function cn(i,l,u,g){var b=T.getUser(),m=new Date,k={kind:"feature",key:i,user:b,value:l?l.value:null,variation:l?l.variationIndex:null,default:u,creationDate:m.getTime()};b&&b.anonymous&&(k.contextKind=Oe(b));var P=y[i];P&&(k.version=P.flagVersion?P.flagVersion:P.version,k.trackEvents=P.trackEvents,k.debugEventsUntilDate=P.debugEventsUntilDate),(g||P&&P.trackReason)&&l&&(k.reason=l.reason),ge(k)}function Ce(i,l,u,g,b){var m;if(y&&ne(y,i)&&y[i]&&!y[i].deleted){var k=y[i];m=se(k),k.value!==null&&k.value!==void 0||(m.value=l)}else m={value:l,variationIndex:null,reason:{kind:"ERROR",errorKind:"FLAG_NOT_FOUND"}};return u&&cn(i,m,l,g),b||function(P,L){E.hasListeners(A.flagUsed)&&E.onFlagUsed(P,L,T.getUser())}(i,m),m}function se(i){return{value:i.value,variationIndex:i.variation===void 0?null:i.variation,reason:i.reason||null}}function Oe(i){return i.anonymous?"anonymousUser":"user"}function ln(i,l){q||i&&l&&ge({kind:"alias",key:i.key,contextKind:Oe(i),previousKey:l.key,previousContextKind:Oe(l),creationDate:new Date().getTime()})}function fn(){if(a=!0,T.getUser()){var i=function(l){try{return JSON.parse(l)}catch{return void f.maybeReportError(new Tn("Invalid data received from LaunchDarkly; connection may have been interrupted"))}};Y.connect(T.getUser(),O,{ping:function(){d.debug("received ping message from stream");var l=T.getUser();V.fetchFlagSettings(l,O).then(function(u){He(l,T.getUser())&&ce(u||{})}).catch(function(u){f.maybeReportError(new ie(Re(u)))})},put:function(l){var u=i(l.data);u&&(d.debug("received streaming update for all flags"),ce(u))},patch:function(l){var u=i(l.data);if(u){var g=y[u.key];if(!g||!g.version||!u.version||g.version<u.version){d.debug(ot(u.key));var b={},m=z({},u);delete m.key,y[u.key]=m;var k=se(m);b[u.key]=g?{previous:g.value,current:k}:{current:k},xe(b),un(u,m)}else d.debug(it(u.key))}},delete:function(l){var u=i(l.data);if(u)if(!y[u.key]||y[u.key].version<u.version){d.debug(at(u.key));var g={};y[u.key]&&!y[u.key].deleted&&(g[u.key]={previous:y[u.key].value}),y[u.key]={version:u.version,deleted:!0},un(u,y[u.key]),xe(g)}else d.debug(ut(u.key))}})}}function Le(){a&&(Y.disconnect(),a=!1)}function ce(i){var l={};if(!i)return Promise.resolve();for(var u in y)ne(y,u)&&y[u]&&(i[u]&&!He(i[u].value,y[u].value)?l[u]={previous:y[u].value,current:se(i[u])}:i[u]&&!i[u].deleted||(l[u]={previous:y[u].value}));for(var g in i)ne(i,g)&&i[g]&&(!y[g]||y[g].deleted)&&(l[g]={current:se(i[g])});return y=$({},i),sn(),xe(l).catch(function(){})}function xe(i){var l=Object.keys(i);if(l.length>0){var u={};l.forEach(function(g){var b=i[g].current,m=b?b.value:void 0,k=i[g].previous;f.emit("change:"+g,m,k),u[g]=b?{current:m,previous:k}:{previous:k}}),f.emit("change",u),f.emit("internal-change",y),v.sendEventsOnlyForVariation||q||l.forEach(function(g){cn(g,i[g].current)})}return s&&ue?ue.saveFlags(y):Promise.resolve()}function Ae(){var i=C||c&&C===void 0;i&&!a?fn():!i&&a&&Le(),J&&J.setStreaming(i)}function Ne(i){return i==="change"||i.substr(0,6+1)==="change:"}if(typeof v.bootstrap=="string"&&v.bootstrap.toUpperCase()==="LOCALSTORAGE"&&(ue?s=!0:d.warn(Xe())),je(v.bootstrap)==="object"&&(y=function(i){var l=Object.keys(i),u=i.$flagsState;!u&&l.length&&d.warn(Bn()),i.$valid===!1&&d.warn("LaunchDarkly bootstrap data is not available because the back end could not read the flags.");var g={};return l.forEach(function(b){if(b!=="$flagsState"&&b!=="$valid"){var m={value:i[b]};u&&u[b]?m=z(m,u[b]):m.version=0,g[b]=m}}),g}(v.bootstrap)),q){var dn=q.getInitialState();dn?vn(dn):q.on("init",vn),q.on("update",function(i){i.user&&T.setUser(i.user),i.flags&&ce(i.flags)})}else(e?an.validateUser(n).then(function(i){return T.setUser(i),je(v.bootstrap)==="object"?pe():s?ue.loadFlags().then(function(l){return l==null?(y={},V.fetchFlagSettings(T.getUser(),O).then(function(u){return ce(u||{})}).then(pe).catch(function(u){Fe(new ie(Re(u)))})):(y=l,Q(pe),V.fetchFlagSettings(T.getUser(),O).then(function(u){return ce(u)}).catch(function(u){return f.maybeReportError(u)}))}):V.fetchFlagSettings(T.getUser(),O).then(function(l){y=l||{},sn(),pe()}).catch(function(l){y={},Fe(l)})}):Promise.reject(new Ye(Jn()))).catch(Fe);function vn(i){p=i.environment,T.setUser(i.user),y=$({},i.flags),Q(pe)}function pe(){d.info("LaunchDarkly client initialized"),N=!0,Ae(),h.signalSuccess()}function Fe(i){h.signalFailure(i)}return{client:{waitForInitialization:function(){return h.getInitializationPromise()},waitUntilReady:function(){return h.getReadyPromise()},identify:function(i,l,u){return K?oe(Promise.resolve({}),u):q?(d.warn("identify() has no effect here; it must be called on the main client instance"),oe(Promise.resolve(Ge(y)),u)):oe((s&&ue?ue.clearFlags():Promise.resolve()).then(function(){return an.validateUser(i)}).then(function(g){return V.fetchFlagSettings(g,l).then(function(b){var m=Ge(b);return T.setUser(g),O=l,b?ce(b).then(function(){return m}):m})}).then(function(g){return a&&fn(),g}).catch(function(g){return f.maybeReportError(g),Promise.reject(g)}),u)},getUser:function(){return T.getUser()},variation:function(i,l){return Ce(i,l,!0,!1,!1).value},variationDetail:function(i,l){return Ce(i,l,!0,!0,!1)},track:function(i,l,u){if(typeof i=="string"){r.customEventFilter&&!r.customEventFilter(i)&&d.warn(We(i));var g=T.getUser(),b={kind:"custom",key:i,user:g,url:r.getCurrentUrl(),creationDate:new Date().getTime()};g&&g.anonymous&&(b.contextKind=Oe(g)),l!=null&&(b.data=l),u!=null&&(b.metricValue=u),ge(b)}else f.maybeReportError(new jn(We(i)))},alias:ln,on:function(i,l,u){Ne(i)?(c=!0,N&&Ae(),f.on(i,l,u)):f.on.apply(f,arguments)},off:function(i){if(f.off.apply(f,arguments),Ne(i)){var l=!1;f.getEvents().forEach(function(u){Ne(u)&&f.getEventListenerCount(u)>0&&(l=!0)}),l||(c=!1,a&&C===void 0&&Le())}},setStreaming:function(i){var l=i===null?void 0:i;l!==C&&(C=l,Ae())},flush:function(i){return oe(w?x.flush():Promise.resolve(),i)},allFlags:function(){var i={};if(!y)return i;for(var l in y)ne(y,l)&&!y[l].deleted&&(i[l]=Ce(l,null,!v.sendEventsOnlyForVariation,!1,!0).value);return i},close:function(i){if(K)return oe(Promise.resolve(),i);var l=function(){K=!0,y={}};return oe(Promise.resolve().then(function(){if(Le(),J&&J.stop(),w)return x.stop(),x.flush()}).then(l).catch(l),i)}},options:v,emitter:f,ident:T,logger:d,requestor:V,start:function(){w&&(J&&J.start(),x.start())},enqueueEvent:ge,getFlagsInternal:function(){return y},getEnvironmentId:function(){return p},internalChangeEventName:"internal-change"}}Object.freeze(A);function Sn(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),t.push.apply(t,r)}return t}function Qe(e){for(var n=1;n<arguments.length;n++){var t=arguments[n]!=null?arguments[n]:{};n%2?Sn(Object(t),!0).forEach(function(r){Lt(e,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Sn(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}return e}function Lt(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var xt=Object.freeze({__proto__:null,commonBasicLogger:_n,createConsoleLogger:nn,get errors(){return Cn},initialize:ht,messages:tn,utils:Fn,version:"3.8.2"}).commonBasicLogger,At=function(e){return xt(Qe({destination:console.log},e))},On={promise:Promise.resolve({status:200,header:function(){return null},body:null})};function Nt(e,n,t,r,o){if(o&&!function(){var f=window.navigator&&window.navigator.userAgent;if(f){var h=f.match(/Chrom(e|ium)\/([0-9]+)\./);if(h)return parseInt(h[2],10)<73}return!0}())return On;var s=new window.XMLHttpRequest;for(var a in s.open(e,n,!o),t||{})Object.prototype.hasOwnProperty.call(t,a)&&s.setRequestHeader(a,t[a]);if(o)return s.send(r),On;var c,d=new Promise(function(f,h){s.addEventListener("load",function(){c||f({status:s.status,header:function(v){return s.getResponseHeader(v)},body:s.responseText})}),s.addEventListener("error",function(){c||h(new Error)}),s.send(r)});return{promise:d,cancel:function(){c=!0,s.abort()}}}function Ft(e){var n,t={synchronousFlush:!1};if(window.XMLHttpRequest){var r=e&&e.disableSyncEventPost;t.httpRequest=function(c,d,f,h){var v=t.synchronousFlush&!r;return t.synchronousFlush=!1,Nt(c,d,f,h,v)}}t.httpAllowsPost=function(){return n===void 0&&(n=!!window.XMLHttpRequest&&"withCredentials"in new window.XMLHttpRequest),n},t.httpFallbackPing=function(c){new window.Image().src=c};var o,s=e&&e.eventUrlTransformer;t.getCurrentUrl=function(){return s?s(window.location.href):window.location.href},t.isDoNotTrack=function(){var c;return(c=window.navigator&&window.navigator.doNotTrack!==void 0?window.navigator.doNotTrack:window.navigator&&window.navigator.msDoNotTrack!==void 0?window.navigator.msDoNotTrack:window.doNotTrack)===1||c===!0||c==="1"||c==="yes"};try{window.localStorage&&(t.localStorage={get:function(c){return new Promise(function(d){d(window.localStorage.getItem(c))})},set:function(c,d){return new Promise(function(f){window.localStorage.setItem(c,d),f()})},clear:function(c){return new Promise(function(d){window.localStorage.removeItem(c),d()})}})}catch{t.localStorage=null}if(e&&e.useReport&&typeof window.EventSourcePolyfill=="function"&&window.EventSourcePolyfill.supportedOptions&&window.EventSourcePolyfill.supportedOptions.method?(t.eventSourceAllowsReport=!0,o=window.EventSourcePolyfill):(t.eventSourceAllowsReport=!1,o=window.EventSource),window.EventSource){var a=3e5;t.eventSourceFactory=function(c,d){var f=Qe(Qe({},{heartbeatTimeout:a,silentTimeout:a,skipDefaultHeaders:!0}),d);return new o(c,f)},t.eventSourceIsActive=function(c){return c.readyState===window.EventSource.OPEN||c.readyState===window.EventSource.CONNECTING}}return t.userAgent="JSClient",t.version="2.24.2",t.diagnosticSdkData={name:"js-client-sdk",version:"2.24.2"},t.diagnosticPlatformData={name:"JS"},t.diagnosticUseCombinedEvent=!0,t}var Je=e=>{if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")};function qt(e,n,t,r){var o,s,a=((e.kind==="substring"||e.kind==="regex")&&r.includes("/")?n:n.replace(r,"")).replace(t,"");switch(e.kind){case"exact":s=n,o=new RegExp("^"+Je(e.url)+"/?$");break;case"canonical":s=a,o=new RegExp("^"+Je(e.url)+"/?$");break;case"substring":s=a,o=new RegExp(".*"+Je(e.substring)+".*$");break;case"regex":s=a,o=new RegExp(e.pattern);break;default:return!1}return o.test(s)}function Pn(e,n){for(var t={},r=null,o=[],s=0;s<e.length;s++)for(var a=e[s],c=a.urls||[],d=0;d<c.length;d++)if(qt(c[d],window.location.href,window.location.search,window.location.hash)){a.kind==="pageview"?n("pageview",a):(o.push(a),n("click_pageview",a));break}return o.length>0&&(r=function(f){for(var h=function(E,w){for(var p=[],O=0;O<w.length;O++)for(var S=E.target,D=w[O],U=D.selector,R=document.querySelectorAll(U);S&&R.length>0;){for(var F=0;F<R.length;F++)S===R[F]&&p.push(D);S=S.parentNode}return p}(f,o),v=0;v<h.length;v++)n("click",h[v])},document.addEventListener("click",r)),t.dispose=function(){document.removeEventListener("click",r)},t}function _t(e,n){var t,r;function o(){r&&r.dispose(),t&&t.length&&(r=Pn(t,s))}function s(a,c){var d=e.ident.getUser(),f={kind:a,key:c.key,data:null,url:window.location.href,user:d,creationDate:new Date().getTime()};return d&&d.anonymous&&(f.contextKind="anonymousUser"),a==="click"&&(f.selector=c.selector),e.enqueueEvent(f)}return e.requestor.fetchJSON("/sdk/goals/"+e.getEnvironmentId()).then(function(a){a&&a.length>0&&(r=Pn(t=a,s),function(c,d){var f,h=window.location.href;function v(){(f=window.location.href)!==h&&(h=f,d())}(function E(w,p){w(),setTimeout(function(){E(w,p)},p)})(v,c),window.history&&window.history.pushState?window.addEventListener("popstate",v):window.addEventListener("hashchange",v)}(300,o)),n()}).catch(function(a){e.emitter.maybeReportError(new Cn.LDUnexpectedResponseError((a&&a.message,a.message))),n()}),{}}var Vt={fetchGoals:{default:!0},hash:{type:"string"},eventProcessor:{type:"object"},eventUrlTransformer:{type:"function"},disableSyncEventPost:{default:!1}};function Mt(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=Ft(t),o=ht(e,n,t,r,Vt),s=o.client,a=o.options,c=o.emitter,d=new Promise(function(h){var v=c.on("goalsReady",function(){c.off("goalsReady",v),h()})});s.waitUntilGoalsReady=function(){return d},a.fetchGoals?_t(o,function(){return c.emit("goalsReady")}):c.emit("goalsReady"),document.readyState!=="complete"?window.addEventListener("load",o.start):o.start();var f=function(){r.synchronousFlush=!0,s.flush().catch(function(){}),r.synchronousFlush=!1};return window.addEventListener("beforeunload",f),window.addEventListener("unload",f),s}var zt=At,Jt=nn,Kt="2.24.2",$t={initialize:function(e,n){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return console&&console.warn&&console.warn(tn.deprecated("default export","named LDClient export")),Mt(e,n,t)},version:"2.24.2"};export{zt as basicLogger,Jt as createConsoleLogger,$t as default,Mt as initialize,Kt as version};
